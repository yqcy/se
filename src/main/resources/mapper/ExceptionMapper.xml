<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd" >
<mapper namespace="com.yq.se.mapper.ExceptionMapper">

    <sql id="table_name">t_exception</sql>
    <sql id="fields">
        id as exception_id,
        username,
        class_full_name,
        description,
        create_date,
        last_update,
        status
    </sql>
    <sql id="values">
        #{exception.id},
        #{exception.user.id},
        #{exception.classFullName},
        #{exception.description},
        #{exception.createDate},
        #{exception.lastUpdate},
        #{exception.status}
    </sql>
    <sql id="set">
        <set>
            <if test="exception.id!=null">id=#{exception.id},</if>
            <if test="exception.user.id!=null">user_id=#{exception.user.id},</if>
            <if test="exception.classFullName!=null">class_full_name=#{exception.classFullName},</if>
            <if test="exception.description!=null">description=#{exception.description},</if>
            <if test="exception.createDate!=null">create_date=#{exception.createDate},</if>
            <if test="exception.lastUpdate!=null">last_update=#{exception.lastUpdate},</if>
            <if test="exception.status!=null">status=#{exception.status}</if>
        </set>
    </sql>
    <resultMap id="exception_user_map" type="com.yq.se.model.Exception">
        <id column="exception_id" property="id"/>
        <result column="class_full_name" property="classFullName"/>
        <result column="description" property="description"/>
        <result column="exception_create_date" property="createDate"/>
        <result column="last_update" property="lastUpdate"/>
        <result column="exception_status" property="status"/>
        <association property="user" javaType="com.yq.se.model.User">
            <id column="user_id" property="id"/>
            <result column="username" property="username"/>
            <result column="password" property="password"/>
            <result column="nickname" property="nickname"/>
            <result column="phone" property="phone"/>
            <result column="user_create_date" property="createDate"/>
            <result column="user_status" property="status"/>
        </association>
    </resultMap>
    <insert id="add">
        insert into
        <include refid="table_name"/>
        values(<include refid="values"/>)
    </insert>
    <update id="modifyById">
        update
        <include refid="table_name"/>
        <include refid="set"/>
        where id = #{exception.id}
    </update>
    <delete id="delete">
        delete from
        <include refid="table_name"/>
        where id = #{exception.id}
    </delete>
    <select id="queryById" resultMap="exception_user_map">
        select
        <include refid="fields"/>
        from
        <include refid="table_name"/>
        where id = #{exception.id}
    </select>
    <select id="queryAll" resultMap="exception_user_map">
        select
        <include refid="fields"/>
        from
        <include refid="table_name"/>
        <if test="sort!=null">
            order by ${sort}
        </if>
        <if test="position > 0">
            <if test="columns > 0">
                limit ${position} , ${columns}
            </if>
        </if>
    </select>
</mapper>